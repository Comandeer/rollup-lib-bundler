{"version":3,"file":"rollup-lib-bundler.mjs","sources":["../../src/bundler/resolveDTSImportPaths.ts","../../src/bundler/rollupPlugins/resolveLinkedBundles.ts","../../src/bundler/bundleTypes.ts","../../src/bundler.ts","../../src/generateBanner.ts","../../src/bundler/rollupPlugins/preserveDynamicImports.ts","../../src/bundler/fixBinPermissions.ts","../../src/OutputController.ts","../../src/packageParser/loadAndParsePackageJSONFile.ts","../../src/packageParser/prepareDistMetadata.ts","../../src/packageParser.ts","../../src/index.ts","../../src/utils/getDistDirPaths.ts"],"sourcesContent":[null,null,null,null,null,null,null,null,null,null,null,null,null],"names":["virtualPrefix","virtualPrefixRegex","RegExp","resolveLinkedBundles","projectPath","metadata","isTypeBundling","name","resolveId","importee","importer","startsWith","resolved","originalExtension","extname","importerDir","dirname","importerWithoutVirtualPrefix","importeeFullPath","join","importeeWithDTSExtension","tsSourceFilePath","importeeWithTSExtension","id","resolveDTSImportPaths","this","resolve","skipSelf","relative","srcPath","entryPoint","isEntryPoint","undefined","types","srcPathRelativeToProject","external","renderChunk","code","chunk","file","chunkFullPath","magicString","MagicString","importerFullPath","slice","distPathRelativeToProject","esm","distFullPath","chunkDirectoryPath","distPathRelativeToChunk","importOrExportString","replace","bundlePath","toString","map","generateMap","async","bundleTypes","packageMetadata","project","userCompilerOptions","tsConfig","tsConfigFilePath","tsConfigContent","ts","readConfigFile","sys","readFile","parseJsonConfigFileContent","config","getUserCompilerOptions","compilerOptions","declaration","emitDeclarationOnly","tsFiles","globby","absolute","cwd","host","createCompilerHost","relativeFilePath","getRelativeToProjectPath","filePath","emittedFiles","input","sourceFile","originalFilePath","tsExtensionRegex","getOriginalDTsFilePath","rollupConfig","plugins","onwarn","outputConfig","format","bundle","rollup","write","bundler","onWarn","source","output","banner","convertCJS","json","renderDynamicImport","left","right","babel","babelrc","babelHelpers","presets","targets","node","extensions","type","pluginConfig","getTSPluginConfig","outputPath","sourcemap","exports","inputConfig","binFilePath","chmod","fixBinPermissions","bundleChunk","OutputController","console","spinner","pendingLogs","pendingWarnings","constructor","stderr","label","stdout","value","TypeError","isValidSpinner","createError","stack","newStack","stackParts","chalk","red","bold","show","hide","push","args","log","warningMessage","warning","createWarning","hideSpinner","forEach","errorLog","error","loadAndParsePackageJSONFile","dirPath","path","ReferenceError","parsed","SyntaxError","obj","version","import","author","license","prepareDistMetadata","packageDir","subpaths","getExportsSubPaths","getBinSubPaths","subPathsMetadata","Promise","all","subPath","subPathGlobPattern","subPathFileName","matchedFiles","fileExtensions","getEntryPoint","subPathFilePath","isBin","isBinSubPath","esmTarget","bin","assert","getBinTarget","getESMTarget","exportType","isTS","toLowerCase","endsWith","getEntryPointType","exportMetadata","typesTarget","getTypesTarget","tsConfigPath","tsConfigGlobPattern","length","find","getTSConfigPath","prepareSubPathMetadata","reduce","currentTargets","subPaths","Object","keys","filter","subpath","includes","packageParser","normalize","dist","prepareMetadata","prepareAuthorMetadata","prepareNodeTarget","engines","rlb","outputController","showSpinner","packageDirectory","process","distDirPaths","Set","values","esmFilePath","esmDistDirPath","typesFilePath","typesDistDirPath","distDir","displayError","display"],"mappings":"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"}