{"version":3,"file":"rollup-lib-bundler.mjs","sources":["../../src/bundler/resolveDTSImportPaths.ts","../../src/bundler/rollupPlugins/resolveLinkedBundles.ts","../../src/bundler/bundleTypes.ts","../../src/targets.ts","../../src/utils/getDirName.ts","../../src/bundler.ts","../../src/generateBanner.ts","../../src/bundler/rollupPlugins/preserveDynamicImports.ts","../../src/bundler/fixBinPermissions.ts","../../src/OutputController.ts","../../src/packageParser.ts","../../src/index.ts","../../src/utils/getDistDirPaths.ts"],"sourcesContent":[null,null,null,null,null,null,null,null,null,null,null,null,null],"names":["virtualPrefix","virtualPrefixRegex","RegExp","resolveLinkedBundles","projectPath","metadata","isTypeBundling","name","resolveId","importee","importer","startsWith","resolved","originalExtension","extname","importerDir","dirname","importerWithoutVirtualPrefix","importeeFullPath","join","importeeWithDTSExtension","tsSourceFilePath","importeeWithTSExtension","id","resolveDTSImportPaths","this","resolve","skipSelf","relative","srcPath","entryPoint","isEntryPoint","undefined","types","srcPathRelativeToProject","external","renderChunk","code","chunk","file","chunkFullPath","magicString","MagicString","importerFullPath","slice","distPathRelativeToProject","esm","distFullPath","chunkDirectoryPath","distPathRelativeToChunk","importOrExportString","replace","bundlePath","toString","map","generateMap","async","bundleTypes","packageInfo","project","userCompilerOptions","tsConfig","tsConfigFilePath","tsConfigContent","ts","readConfigFile","sys","readFile","parseJsonConfigFileContent","config","getUserCompilerOptions","compilerOptions","declaration","emitDeclarationOnly","tsFiles","globby","absolute","cwd","host","createCompilerHost","relativeFilePath","getRelativeToProjectPath","filePath","emittedFiles","input","sourceFile","originalFilePath","tsExtensionRegex","getOriginalDTsFilePath","rollupConfig","plugins","onwarn","outputConfig","format","bundle","rollup","write","__dirname","url","packageJSONFilePath","packageJSONFileContent","engines","JSON","parse","node","bundler","onWarn","source","output","banner","convertCJS","json","renderDynamicImport","left","right","babel","babelrc","babelHelpers","presets","targets","extensions","type","pluginConfig","getTSPluginConfig","outputPath","sourcemap","exports","inputConfig","binFilePath","chmod","fixBinPermissions","bundleChunk","OutputController","console","spinner","pendingLogs","pendingWarnings","constructor","stderr","label","stdout","value","TypeError","isValidSpinner","createError","stack","newStack","stackParts","chalk","red","bold","show","hide","push","args","log","warningMessage","warning","createWarning","hideSpinner","forEach","errorLog","error","packageParser","packageDir","dirPath","path","ReferenceError","parsed","SyntaxError","loadAndParsePackageJSONFile","obj","version","author","license","normalize","dist","prepareMetadata","prepareAuthorMetadata","prepareDistMetadata","subpaths","subPaths","Object","keys","filter","subpath","includes","binSubPaths","bin","getBinSubPaths","getSubPaths","subPathsMetadata","Promise","all","subPath","subPathGlobPattern","subPathFileName","matchedFiles","fileExtensions","getEntryPoint","subPathFilePath","isBin","isBinSubPath","esmTarget","getBinTarget","exportsTarget","getESMTarget","exportType","isTS","getEntryPointType","exportMetadata","typesTarget","getTypesTarget","tsConfigPath","tsConfigGlobPattern","length","find","endsWith","getTSConfigPath","prepareSubPathMetadata","reduce","currentTargets","getExportsTarget","rlb","outputController","showSpinner","packageDirectory","process","distDirPaths","Set","values","esmFilePath","esmDistDirPath","typesFilePath","typesDistDirPath","distDir","displayError","display"],"mappings":"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"}