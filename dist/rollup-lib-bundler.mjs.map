{"version":3,"file":"rollup-lib-bundler.mjs","sources":["../../src/bundler/resolveDTSImportPaths.ts","../../src/bundler/rollupPlugins/resolveLinkedBundles.ts","../../src/bundler/bundleTypes.ts","../../src/bundler.ts","../../src/generateBanner.ts","../../src/bundler/rollupPlugins/preserveDynamicImports.ts","../../src/bundler/fixBinPermissions.ts","../../src/OutputController.ts","../../src/packageParser/PackageJSON.ts","../../src/packageParser/loadAndParsePackageJSONFile.ts","../../src/packageParser/prepareDistMetadata.ts","../../src/packageParser.ts","../../src/index.ts","../../src/utils/getDistDirPaths.ts"],"sourcesContent":[null,null,null,null,null,null,null,null,null,null,null,null,null,null],"names":["virtualPrefix","virtualPrefixRegex","RegExp","resolveLinkedBundles","projectPath","metadata","isTypeBundling","name","resolveId","importee","importer","startsWith","resolved","originalExtension","extname","importerDir","dirname","importerWithoutVirtualPrefix","importeeFullPath","join","importeeWithDTSExtension","tsSourceFilePath","importeeWithTSExtension","id","resolveDTSImportPaths","this","resolve","skipSelf","relative","srcPath","entryPoint","isEntryPoint","undefined","types","srcPathRelativeToProject","external","renderChunk","code","chunk","file","chunkFullPath","magicString","MagicString","importerFullPath","slice","distPathRelativeToProject","esm","distFullPath","chunkDirectoryPath","distPathRelativeToChunk","importOrExportString","replace","bundlePath","toString","map","generateMap","async","bundleTypes","packageMetadata","project","userCompilerOptions","tsConfig","tsConfigFilePath","tsConfigContent","ts","readConfigFile","sys","readFile","parseJsonConfigFileContent","config","getUserCompilerOptions","compilerOptions","declaration","emitDeclarationOnly","tsFiles","globby","absolute","cwd","host","createCompilerHost","relativeFilePath","getRelativeToProjectPath","filePath","emittedFiles","input","sourceFile","originalFilePath","tsExtensionRegex","getOriginalDTsFilePath","rollupConfig","plugins","onwarn","outputConfig","format","bundle","rollup","write","bundler","onWarn","source","output","banner","json","renderDynamicImport","left","right","babel","babelrc","babelHelpers","presets","targets","node","extensions","type","pluginConfig","getTSPluginConfig","outputPath","sourcemap","exports","inputConfig","binFilePath","chmod","fixBinPermissions","bundleChunk","console","spinner","pendingLogs","pendingWarnings","constructor","stderr","label","stdout","value","TypeError","isValidSpinner","createError","stack","newStack","stackParts","chalk","red","bold","show","hide","push","args","log","warningMessage","warning","OutputController","createWarning","hideSpinner","forEach","errorLog","error","isConditionalExport","obj","keys","Object","length","every","key","isSubPathExports","isSubPath","loadAndParsePackageJSONFile","dirPath","path","ReferenceError","parsed","SyntaxError","version","isESMEntryPointPresent","author","license","prepareDistMetadata","packageDir","subpaths","getExportsSubPaths","getBinSubPaths","subPathsMetadata","Promise","all","subPath","subPathGlobPattern","subPathFileName","matchedFiles","fileExtensions","getEntryPoint","subPathFilePath","isBin","isBinSubPath","esmTarget","bin","assert","getBinTarget","import","getESMTarget","exportType","isTS","toLowerCase","endsWith","getEntryPointType","exportMetadata","typesTarget","getTypesTarget","tsConfigPath","tsConfigGlobPattern","find","getTSConfigPath","prepareSubPathMetadata","reduce","currentTargets","subPaths","filter","includes","packageParser","normalize","dist","prepareMetadata","prepareAuthorMetadata","prepareNodeTarget","engines","rlb","outputController","showSpinner","packageDirectory","process","distDirPaths","Set","values","esmFilePath","esmDistDirPath","typesFilePath","typesDistDirPath","distDir","displayError","display"],"mappings":"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"}